<?xml version="1.0" encoding="utf-8" ?>
<nlog xmlns="http://www.nlog-project.org/schemas/NLog.xsd"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      autoReload="true"
      internalLogLevel="Info"
      throwExceptions="true"
      internalLogFile="c:\temp\internal-nlog-AspNetCore.txt">

  <!-- 啟用 ASP.NET Core layout renderers -->
  <extensions>
    <add assembly="NLog.Web.AspNetCore"/>
  </extensions>

  <!-- 設定變數 -->
  <variable name="logDirectory" value="${basedir}/logs" />

  <!-- 定義日誌輸出目標 -->
  <targets>
    <!-- 檔案目標 - 所有日誌 -->
    <!-- <target xsi:type="File" name="allfile"
            fileName="${logDirectory}/nlog-all-${shortdate}.log"
            layout="${longdate}|${event-properties:item=EventId:whenEmpty=0}|${level:uppercase=true}|${logger}|${message} ${exception:format=tostring}" /> -->

    <!-- 檔案目標 - 僅應用程式日誌 -->
    <!-- <target xsi:type="File" name="ownFile-web"
            fileName="${logDirectory}/nlog-own-${shortdate}.log"
            layout="${longdate}|${event-properties:item=EventId:whenEmpty=0}|${level:uppercase=true}|${logger}|${message} ${exception:format=tostring}|url: ${aspnet-request-url}|action: ${aspnet-mvc-action}" /> -->

    <!-- 檔案目標 - 錯誤日誌 -->
    <!-- <target xsi:type="File" name="errorFile"
            fileName="${logDirectory}/nlog-error-${shortdate}.log"
            layout="${longdate}|${event-properties:item=EventId:whenEmpty=0}|${level:uppercase=true}|${logger}|${message} ${exception:format=tostring}|url: ${aspnet-request-url}|action: ${aspnet-mvc-action}" /> -->

    <!-- 控制台目標 -->
    <!-- <target xsi:type="Console" name="lifetimeConsole"
            layout="NLog: ${level:truncate=4:tolower=true}\: ${logger}[0]${newline}      ${message}${exception:format=tostring}" /> -->
    <target xsi:type="Console" name="lifetimeConsole"
            layout="NLog:    [${longdate} ${level:truncate=4:toupper=true}] ${logger} ${message}${exception:format=tostring}" />

    <!-- 彩色控制台目標 -->
    <!-- <target xsi:type="ColoredConsole" name="colorConsole"
            layout="NLog: ${longdate} ${level:uppercase=true} ${logger} ${message} ${exception:format=tostring}">
      <highlight-row condition="level == LogLevel.Debug" foregroundColor="DarkGray" />
      <highlight-row condition="level == LogLevel.Info" foregroundColor="Gray" />
      <highlight-row condition="level == LogLevel.Warn" foregroundColor="Yellow" />
      <highlight-row condition="level == LogLevel.Error" foregroundColor="Red" />
      <highlight-row condition="level == LogLevel.Fatal" foregroundColor="Magenta" />
    </target> -->

    <!-- 偵錯輸出目標 -->
    <!-- <target xsi:type="Debugger" name="debugger"
            layout="${date:format=HH\:mm\:ss.fff}: ${message}" /> -->

    <!-- 結構化 JSON 檔案目標 -->
    <!-- <target xsi:type="File" name="jsonFile"
            fileName="${logDirectory}/nlog-json-${shortdate}.log">
      <layout xsi:type="JsonLayout" includeAllProperties="true">
        <attribute name="time" layout="${longdate}" />
        <attribute name="level" layout="${level:uppercase=true}" />
        <attribute name="logger" layout="${logger}" />
        <attribute name="message" layout="${message}" />
        <attribute name="exception" layout="${exception:format=tostring}" />
        <attribute name="url" layout="${aspnet-request-url}" />
        <attribute name="action" layout="${aspnet-mvc-action}" />
        <attribute name="callsite" layout="${callsite}" />
        <attribute name="machinename" layout="${machinename}" />
        <attribute name="processid" layout="${processid}" />
        <attribute name="threadid" layout="${threadid}" />
      </layout>
    </target>-->
  </targets> 

  <!-- 定義日誌規則 -->
  <rules>
    <!-- 所有日誌寫入 allfile，但排除系統日誌 -->
    <!-- <logger name="*" minlevel="Trace" writeTo="allfile" /> -->

    <!-- 跳過非關鍵的 Microsoft 日誌，提升效能 -->
    <!-- <logger name="Microsoft.*" maxlevel="Info" final="true" /> -->
    <!-- <logger name="System.Net.Http.*" maxlevel="Info" final="true" /> -->

    <!-- 應用程式日誌 -->
    <!-- <logger name="WebUseNLogSerilog.*" minlevel="Trace" writeTo="ownFile-web" /> -->

    <!-- 錯誤等級日誌 -->
    <!-- <logger name="*" minlevel="Error" writeTo="errorFile" /> -->

    <!-- 控制台輸出 -->
    <!-- <logger name="*" minlevel="Info" writeTo="colorConsole" /> -->
    <logger name="*" minlevel="Info" writeTo="lifetimeConsole" />

    <!-- JSON 格式日誌 -->
    <!-- <logger name="*" minlevel="Debug" writeTo="jsonFile" /> -->

    <!-- 開發環境偵錯輸出 -->
    <!-- <logger name="*" minlevel="Debug" writeTo="debugger" /> -->
  </rules>
</nlog>